<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>별돌깨기 웹버전</title>
    <style>
        body { background: #222; display: flex; justify-content: center; align-items: center; height: 100vh; }
        canvas { background: #000; display: block; margin: 0 auto; border: 2px solid #fff; }
    </style>
</head>
<body>
<canvas id="gameCanvas" width="800" height="600"></canvas>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

// 게임 설정
const SCREEN_WIDTH = 800;
const SCREEN_HEIGHT = 600;
const BRICK_ROWS = 5;
const BRICK_COLS = 10;
const BRICK_WIDTH = 70;
const BRICK_HEIGHT = 30;
const PADDLE_WIDTH = 100;
const PADDLE_HEIGHT = 15;
const BALL_RADIUS = 10;

// 색상
const COLORS = {
    WHITE: "#fff",
    BLACK: "#000",
    BLUE: "#0066cc",
    RED: "#ff0000",
    GREEN: "#00ff00"
};

// 벽돌 배열 생성
let bricks = [];
for (let row = 0; row < BRICK_ROWS; row++) {
    for (let col = 0; col < BRICK_COLS; col++) {
        bricks.push({
            x: col * (BRICK_WIDTH + 5) + 35,
            y: row * (BRICK_HEIGHT + 5) + 40,
            width: BRICK_WIDTH,
            height: BRICK_HEIGHT,
            alive: true
        });
    }
}

// 패들
let paddle = {
    x: (SCREEN_WIDTH - PADDLE_WIDTH) / 2,
    y: SCREEN_HEIGHT - 30 - PADDLE_HEIGHT / 2,
    width: PADDLE_WIDTH,
    height: PADDLE_HEIGHT,
    speed: 8,
    dx: 0
};

// 공
let ball = {
    x: SCREEN_WIDTH / 2,
    y: SCREEN_HEIGHT / 2,
    dx: Math.random() < 0.5 ? -4 : 4,
    dy: -4,
    radius: BALL_RADIUS
};

let gameOver = false;
let gameClear = false;
let gameStarted = false;

// 키 입력 처리
document.addEventListener('keydown', function(e) {
    if (e.key === "ArrowLeft") paddle.dx = -paddle.speed;
    if (e.key === "ArrowRight") paddle.dx = paddle.speed;
    if (!gameStarted && e.code === "Space") {
        gameStarted = true;
        requestAnimationFrame(gameLoop);
    }
});
document.addEventListener('keyup', function(e) {
    if (e.key === "ArrowLeft" || e.key === "ArrowRight") paddle.dx = 0;
});

// 게임 루프
function gameLoop() {
    update();
    render();
    if (!gameOver && !gameClear) {
        requestAnimationFrame(gameLoop);
    }
}

function update() {
    if (!gameStarted) return;

    // 패들 이동
    paddle.x += paddle.dx;
    if (paddle.x < 0) paddle.x = 0;
    if (paddle.x + paddle.width > SCREEN_WIDTH) paddle.x = SCREEN_WIDTH - paddle.width;

    // 공 이동
    ball.x += ball.dx;
    ball.y += ball.dy;

    // 벽 충돌
    if (ball.x - ball.radius < 0 || ball.x + ball.radius > SCREEN_WIDTH) {
        ball.dx *= -1;
    }
    if (ball.y - ball.radius < 0) {
        ball.dy *= -1;
    }

    // 패들 충돌
    if (
        ball.x + ball.radius > paddle.x &&
        ball.x - ball.radius < paddle.x + paddle.width &&
        ball.y + ball.radius > paddle.y &&
        ball.y - ball.radius < paddle.y + paddle.height
    ) {
        ball.dy *= -1;
        ball.y = paddle.y - ball.radius; // 패들 위로 위치 조정
    }

    // 벽돌 충돌
    for (let brick of bricks) {
        if (brick.alive &&
            ball.x + ball.radius > brick.x &&
            ball.x - ball.radius < brick.x + brick.width &&
            ball.y + ball.radius > brick.y &&
            ball.y - ball.radius < brick.y + brick.height
        ) {
            ball.dy *= -1;
            brick.alive = false;
            break;
        }
    }

    // 바닥에 닿으면 게임 오버
    if (ball.y - ball.radius > SCREEN_HEIGHT) {
        gameOver = true;
    }

    // 모든 벽돌 제거 시 게임 클리어
    if (bricks.every(b => !b.alive)) {
        gameClear = true;
    }
}

function render() {
    // 화면 지우기
    ctx.clearRect(0, 0, SCREEN_WIDTH, SCREEN_HEIGHT);

    // 벽돌 그리기
    for (let brick of bricks) {
        if (brick.alive) {
            ctx.fillStyle = COLORS.BLUE;
            ctx.fillRect(brick.x, brick.y, brick.width, brick.height);
        }
    }

    // 패들 그리기
    ctx.fillStyle = COLORS.GREEN;
    ctx.fillRect(paddle.x, paddle.y, paddle.width, paddle.height);

    // 공 그리기
    ctx.beginPath();
    ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
    ctx.fillStyle = COLORS.RED;
    ctx.fill();
    ctx.closePath();

    // 게임 오버/클리어 메시지
    ctx.fillStyle = COLORS.WHITE;
    ctx.font = "60px Arial";
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    if (!gameStarted) {
        ctx.fillText("스페이스바를 눌러 시작!", SCREEN_WIDTH / 2, SCREEN_HEIGHT / 2);
    } else if (gameOver || gameClear) {
        ctx.fillText(gameClear ? "CLEAR!" : "GAME OVER", SCREEN_WIDTH / 2, SCREEN_HEIGHT / 2);
    }
}

// 첫 화면 렌더링
render();
</script>
</body>
</html>